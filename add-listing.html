<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>إضافة إعلان جديد - SudanCars</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f47b25",
                        "primary-hover": "#e06d1a",
                        "background-light": "#f8f7f5",
                        "background-dark": "#120d0b",
                        "navy-custom": "#1a2b3c",
                        "whatsapp": "#25D366",
                    },
                    fontFamily: {
                        "display": ["Noto Sans Arabic", "sans-serif"]
                    },
                },
            },
        }
    </script>
    <style>
        body { font-family: 'Noto Sans Arabic', sans-serif; }
        .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
        .btn-primary {
            background: linear-gradient(135deg, #f47b25 0%, #e06d1a 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(244, 123, 37, 0.5);
        }
        .input-field {
            transition: all 0.3s ease;
        }
        .input-field:focus {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(244, 123, 37, 0.15);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .dark .glass-effect { background: rgba(18, 13, 11, 0.95); }
        .payment-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .payment-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .payment-card.selected {
            border-color: #f47b25;
            background-color: rgba(244, 123, 37, 0.05);
        }
        .image-preview {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%239ca3af'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z'/%3E%3C/svg%3E");
            background-size: 48px;
            background-position: center;
            background-repeat: no-repeat;
        }
        .step-content {
            display: none;
        }
        .step-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 font-display antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="sticky top-0 z-50 w-full glass-effect border-b border-slate-200 dark:border-slate-800 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="index.html" class="flex items-center gap-3 shrink-0 cursor-pointer group">
                    <div class="text-primary group-hover:scale-110 transition-transform">
                        <span class="material-symbols-outlined text-4xl">directions_car</span>
                    </div>
                    <div class="flex flex-col">
                        <h1 class="text-2xl font-black tracking-tight leading-none text-navy-custom dark:text-white">SudanCars</h1>
                        <span class="text-[10px] text-slate-500 font-medium tracking-widest">السودان للسيارات</span>
                    </div>
                </a>
                <button onclick="toggleDarkMode()" class="w-10 h-10 flex items-center justify-center rounded-xl text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all">
                    <span class="material-symbols-outlined dark:hidden">dark_mode</span>
                    <span class="material-symbols-outlined hidden dark:block">light_mode</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 py-8">
        <div class="max-w-4xl mx-auto px-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-700 overflow-hidden">
                
                <!-- Header -->
                <div class="bg-navy-custom text-white p-6">
                    <h2 class="text-2xl font-black mb-2">إضافة إعلان جديد</h2>
                    <p class="text-slate-300 text-sm">أضف سيارتك للبيع في خطوات بسيطة</p>
                </div>

                <!-- Progress -->
                <div class="flex border-b border-slate-200 dark:border-slate-700">
                    <div class="flex-1 py-4 text-center border-b-2 border-primary text-primary font-bold bg-primary/5" id="step1Tab">
                        <span class="material-symbols-outlined align-middle ml-1">directions_car</span> بيانات السيارة
                    </div>
                    <div class="flex-1 py-4 text-center border-b-2 border-transparent text-slate-500 font-bold" id="step2Tab">
                        <span class="material-symbols-outlined align-middle ml-1">image</span> الصور
                    </div>
                    <div class="flex-1 py-4 text-center border-b-2 border-transparent text-slate-500 font-bold" id="step3Tab">
                        <span class="material-symbols-outlined align-middle ml-1">payment</span> الدفع
                    </div>
                </div>

                <form id="listingForm" onsubmit="handleSubmit(event)">
                    
                    <!-- Step 1: Car Details -->
                    <div class="step-content active p-6" id="step1">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Brand -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">الماركة *</label>
                                <select name="brand" id="brandSelect" onchange="updateModels()" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر الماركة</option>
                                </select>
                            </div>

                            <!-- Model -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">الموديل *</label>
                                <select name="model" id="modelSelect" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required disabled>
                                    <option value="">اختر الموديل</option>
                                </select>
                            </div>

                            <!-- Year -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">سنة الصنع *</label>
                                <select name="year" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر السنة</option>
                                </select>
                            </div>

                            <!-- State -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">الولاية *</label>
                                <select name="state" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر الولاية</option>
                                </select>
                            </div>

                            <!-- City -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">المدينة *</label>
                                <input type="text" name="city" placeholder="مثال: الخرطوم، بحري، أم درمان" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 text-right input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                            </div>

                            <!-- Price -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">السعر (جنيه سوداني) *</label>
                                <div class="relative">
                                    <input type="number" name="price" placeholder="5000000" min="100000" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 pl-12 pr-4 text-right input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold">ج.س</span>
                                </div>
                            </div>

                            <!-- Mileage -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">المسافة المقطوعة (كم) *</label>
                                <input type="number" name="mileage" placeholder="50000" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 text-right input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                            </div>

                            <!-- Fuel Type -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">نوع الوقود *</label>
                                <select name="fuelType" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر نوع الوقود</option>
                                    <option value="gasoline">بنزين</option>
                                    <option value="diesel">ديزل</option>
                                    <option value="hybrid">هجين</option>
                                    <option value="electric">كهربائي</option>
                                </select>
                            </div>

                            <!-- Transmission -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">ناقل الحركة *</label>
                                <select name="transmission" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر نوع الناقل</option>
                                    <option value="automatic">أوتوماتيك</option>
                                    <option value="manual">عادي</option>
                                    <option value="cvt">CVT</option>
                                </select>
                            </div>

                            <!-- Condition -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">الحالة *</label>
                                <select name="condition" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر الحالة</option>
                                    <option value="new">جديد</option>
                                    <option value="excellent">ممتاز</option>
                                    <option value="good">جيد</option>
                                    <option value="fair">مقبول</option>
                                </select>
                            </div>

                            <!-- Color -->
                            <div>
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">اللون *</label>
                                <select name="color" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20" required>
                                    <option value="">اختر اللون</option>
                                    <option value="white">أبيض</option>
                                    <option value="black">أسود</option>
                                    <option value="silver">فضي</option>
                                    <option value="gray">رمادي</option>
                                    <option value="red">أحمر</option>
                                    <option value="blue">أزرق</option>
                                    <option value="green">أخضر</option>
                                    <option value="gold">ذهبي</option>
                                    <option value="brown">بني</option>
                                    <option value="other">أخرى</option>
                                </select>
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="mt-6">
                            <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">وصف السيارة *</label>
                            <textarea name="description" rows="4" placeholder="اكتب وصفاً تفصيلياً للسيارة، مواصفاتها، حالتها، وسبب البيع..." class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl py-3 px-4 text-right input-field focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 resize-none" required></textarea>
                        </div>

                        <!-- Features -->
                        <div class="mt-6">
                            <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-3">المواصفات الإضافية</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="ac" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">مكيف</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="abs" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">فرامل ABS</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="airbags" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">وسائد هوائية</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="sunroof" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">فتحة سقف</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="leather" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">مقاعد جلد</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="navigation" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">نظام ملاحة</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="camera" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">كاميرا خلفية</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="features" value="sensors" class="w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary">
                                    <span class="text-sm">حساسات</span>
                                </label>
                            </div>
                        </div>

                        <div class="mt-8 flex justify-end">
                            <button type="button" onclick="goToStep(2)" class="btn-primary text-white font-bold py-3 px-8 rounded-xl flex items-center gap-2">
                                <span>الخطوة التالية</span>
                                <span class="material-symbols-outlined">arrow_back</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Images -->
                    <div class="step-content p-6" id="step2">
                        <div class="mb-6">
                            <h3 class="text-lg font-bold text-navy-custom dark:text-white mb-2">صور السيارة</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">أضف صوراً واضحة للسيارة من عدة زوايا (الحد الأدنى 3 صور)</p>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <!-- Main Image -->
                            <div class="col-span-2 row-span-2">
                                <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">الصورة الرئيسية *</label>
                                <div class="relative h-full min-h-[200px] border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden cursor-pointer hover:border-primary transition-colors image-preview bg-slate-50 dark:bg-slate-700" onclick="document.getElementById('mainImage').click()">
                                    <input type="file" id="mainImage" accept="image/*" class="hidden" onchange="previewImage(this, 'mainPreview')" required>
                                    <img id="mainPreview" class="w-full h-full object-cover hidden">
                                    <div class="absolute inset-0 flex flex-col items-center justify-center text-slate-400" id="mainPlaceholder">
                                        <span class="material-symbols-outlined text-4xl mb-2">add_photo_alternate</span>
                                        <span class="text-sm">اضغط لإضافة الصورة الرئيسية</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Images -->
                            <div>
                                <div class="relative h-32 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden cursor-pointer hover:border-primary transition-colors image-preview bg-slate-50 dark:bg-slate-700" onclick="document.getElementById('img2').click()">
                                    <input type="file" id="img2" accept="image/*" class="hidden" onchange="previewImage(this, 'preview2')">
                                    <img id="preview2" class="w-full h-full object-cover hidden">
                                </div>
                            </div>
                            <div>
                                <div class="relative h-32 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden cursor-pointer hover:border-primary transition-colors image-preview bg-slate-50 dark:bg-slate-700" onclick="document.getElementById('img3').click()">
                                    <input type="file" id="img3" accept="image/*" class="hidden" onchange="previewImage(this, 'preview3')">
                                    <img id="preview3" class="w-full h-full object-cover hidden">
                                </div>
                            </div>
                            <div>
                                <div class="relative h-32 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden cursor-pointer hover:border-primary transition-colors image-preview bg-slate-50 dark:bg-slate-700" onclick="document.getElementById('img4').click()">
                                    <input type="file" id="img4" accept="image/*" class="hidden" onchange="previewImage(this, 'preview4')">
                                    <img id="preview4" class="w-full h-full object-cover hidden">
                                </div>
                            </div>
                            <div>
                                <div class="relative h-32 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden cursor-pointer hover:border-primary transition-colors image-preview bg-slate-50 dark:bg-slate-700" onclick="document.getElementById('img5').click()">
                                    <input type="file" id="img5" accept="image/*" class="hidden" onchange="previewImage(this, 'preview5')">
                                    <img id="preview5" class="w-full h-full object-cover hidden">
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between mt-8">
                            <button type="button" onclick="goToStep(1)" class="py-3 px-8 border border-slate-300 dark:border-slate-600 rounded-xl font-bold text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all">
                                رجوع
                            </button>
                            <button type="button" onclick="goToStep(3)" class="btn-primary text-white font-bold py-3 px-8 rounded-xl flex items-center gap-2">
                                <span>الخطوة التالية</span>
                                <span class="material-symbols-outlined">arrow_back</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Payment -->
                    <div class="step-content p-6" id="step3">
                        <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-4 mb-6">
                            <div class="flex items-start gap-3">
                                <span class="material-symbols-outlined text-yellow-600 dark:text-yellow-400">info</span>
                                <div>
                                    <h4 class="font-bold text-yellow-800 dark:text-yellow-200 mb-1">رسوم نشر الإعلان</h4>
                                    <p class="text-sm text-yellow-700 dark:text-yellow-300">رسوم إضافة الإعلان هي <span class="font-bold text-2xl text-primary">5,000</span> جنيه سوداني فقط. الإعلان يظل منشوراً لمدة 30 يوماً.</p>
                                </div>
                            </div>
                        </div>

                        <h3 class="text-lg font-bold text-navy-custom dark:text-white mb-4">اختر طريقة الدفع</h3>

                        <div class="space-y-4 mb-6">
                            <!-- Bankak -->
                            <div class="payment-card border-2 border-slate-200 dark:border-slate-600 rounded-xl p-4" onclick="selectPayment('bankak')" id="bankakCard">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center text-blue-600">
                                            <span class="material-symbols-outlined text-2xl">account_balance</span>
                                        </div>
                                        <div>
                                            <h4 class="font-bold text-navy-custom dark:text-white">بنكك (Bankak)</h4>
                                            <p class="text-sm text-slate-500 dark:text-slate-400">تحويل مباشر عبر تطبيق بنكك</p>
                                        </div>
                                    </div>
                                    <div class="w-6 h-6 rounded-full border-2 border-slate-300 dark:border-slate-600 flex items-center justify-center" id="bankakCheck">
                                        <div class="w-3 h-3 rounded-full bg-primary hidden"></div>
                                    </div>
                                </div>
                                <div class="mt-4 pt-4 border-t border-slate-200 dark:border-slate-700 hidden" id="bankakDetails">
                                    <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                        <p class="text-sm text-slate-600 dark:text-slate-300 mb-2">رقم حساب الشركة:</p>
                                        <div class="flex items-center justify-between bg-white dark:bg-slate-600 rounded-lg p-3">
                                            <span class="font-mono font-bold text-lg text-navy-custom dark:text-white" id="bankakNumber">1234567</span>
                                            <button type="button" onclick="copyToClipboard('1234567')" class="text-primary hover:text-primary-hover font-bold text-sm flex items-center gap-1">
                                                <span class="material-symbols-outlined text-sm">content_copy</span> نسخ
                                            </button>
                                        </div>
                                        <p class="text-xs text-slate-500 mt-2">اسم الحساب: شركة سودان كارز</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Fawry -->
                            <div class="payment-card border-2 border-slate-200 dark:border-slate-600 rounded-xl p-4" onclick="selectPayment('fawry')" id="fawryCard">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center text-orange-600">
                                            <span class="material-symbols-outlined text-2xl">payments</span>
                                        </div>
                                        <div>
                                            <h4 class="font-bold text-navy-custom dark:text-white">فوري (Fawry)</h4>
                                            <p class="text-sm text-slate-500 dark:text-slate-400">دفع عبر محلات فوري أو التطبيق</p>
                                        </div>
                                    </div>
                                    <div class="w-6 h-6 rounded-full border-2 border-slate-300 dark:border-slate-600 flex items-center justify-center" id="fawryCheck">
                                        <div class="w-3 h-3 rounded-full bg-primary hidden"></div>
                                    </div>
                                </div>
                                <div class="mt-4 pt-4 border-t border-slate-200 dark:border-slate-700 hidden" id="fawryDetails">
                                    <div class="bg-slate-50 dark:bg-slate-700 rounded-lg p-4">
                                        <p class="text-sm text-slate-600 dark:text-slate-300 mb-2">رقم حساب الشركة:</p>
                                        <div class="flex items-center justify-between bg-white dark:bg-slate-600 rounded-lg p-3">
                                            <span class="font-mono font-bold text-lg text-navy-custom dark:text-white" id="fawryNumber">1234567</span>
                                            <button type="button" onclick="copyToClipboard('1234567')" class="text-primary hover:text-primary-hover font-bold text-sm flex items-center gap-1">
                                                <span class="material-symbols-outlined text-sm">content_copy</span> نسخ
                                            </button>
                                        </div>
                                        <p class="text-xs text-slate-500 mt-2">كود الخدمة: 6789</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Proof Upload -->
                        <div class="border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl p-6 text-center mb-6" id="proofUpload">
                            <input type="file" id="paymentProof" accept="image/*" class="hidden" onchange="handleProofUpload(this)">
                            <div onclick="document.getElementById('paymentProof').click()" class="cursor-pointer">
                                <span class="material-symbols-outlined text-4xl text-slate-400 mb-2">receipt_long</span>
                                <h4 class="font-bold text-navy-custom dark:text-white mb-1">أرفق صورة إيصال الدفع</h4>
                                <p class="text-sm text-slate-500 dark:text-slate-400 mb-3">صورة واضحة من تطبيق بنكك أو فوري</p>
                                <button type="button" class="text-primary font-bold text-sm hover:underline">اختر ملف</button>
                            </div>
                            <div id="proofPreview" class="hidden mt-4">
                                <img class="max-h-48 mx-auto rounded-lg shadow-md">
                                <button type="button" onclick="removeProof()" class="mt-2 text-red-500 text-sm hover:underline">إزالة الصورة</button>
                            </div>
                        </div>

                        <!-- Contact Info -->
                        <div class="bg-slate-50 dark:bg-slate-700 rounded-xl p-4 mb-6">
                            <h4 class="font-bold text-navy-custom dark:text-white mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-primary">contact_support</span> للاستفسارات
                            </h4>
                            <div class="space-y-2 text-sm">
                                <div class="flex items-center gap-2 text-slate-600 dark:text-slate-300">
                                    <span class="material-symbols-outlined text-slate-400">phone</span>
                                    <span>+249 125 798 205</span>
                                </div>
                                <div class="flex items-center gap-2 text-slate-600 dark:text-slate-300">
                                    <span class="material-symbols-outlined text-slate-400">mail</span>
                                    <span>osamaabd364@gmail.com</span>
                                </div>
                                <div class="flex items-center gap-2 text-slate-600 dark:text-slate-300">
                                    <span class="material-symbols-outlined text-slate-400">chat</span>
                                    <a href="https://wa.me/249125798205" target="_blank" class="text-whatsapp hover:underline">واتساب مباشرة</a>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between mt-8">
                            <button type="button" onclick="goToStep(2)" class="py-3 px-8 border border-slate-300 dark:border-slate-600 rounded-xl font-bold text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all">
                                رجوع
                            </button>
                            <button type="submit" id="submitBtn" class="btn-primary text-white font-bold py-3 px-8 rounded-xl flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                <span class="material-symbols-outlined">check_circle</span>
                                <span>إرسال الإعلان</span>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-xl shadow-2xl transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-2">
        <span class="material-symbols-outlined text-primary">info</span>
        <span id="toastMessage">رسالة</span>
    </div>

    <script>
        // Data
        const carBrands = ["تويوتا", "هيونداي", "كيا", "مرسيدس", "بي إم دبليو", "نيسان", "ميتسوبيشي", "شيفروليه", "فورد", "هوندا", "ليكزس", "جيب", "أودي", "فولكس فاجن", "سوزوكي", "إيسوزو", "شانجان", "جيلي", "بي واي دي", "مازدا", "سوبارو", "رينو", "بيجو", "سيتروين", "هافال", "شيري", "MG", "تانك", "لافيدا", "كريستال"];
        
        const carModels = {
            "تويوتا": ["كامري", "كورولا", "لاندكروزر", "هايلوكس", "راف فور", "برادو", "فورتشنر", "ياريس", "أفالون", "سيكويا", "انوفا", "راش", "C-HR", "هايس"],
            "هيونداي": ["توسان", "إلنترا", "سوناتا", "كريتا", "سانتافيه", "i10", "i20", "i30", "أكسنت", "باليساد", "فينيو", "كازا", "ستاريا"],
            "كيا": ["سبورتاج", "سيراتو", "أوبتيما", "سورينتو", "ريو", "بيكانتو", "سيد", "كارينز", "موهافي", "تيلورايد", "ستونيك", "سيلتوس"],
            "مرسيدس": ["E300", "C200", "S500", "GLE", "GLC", "A200", "CLA", "GLA", "G63", "مايباخ", "C300", "E200", "S400", "GLS", "G500"],
            "نيسان": ["التيما", "باترول", "صني", "نيفارا", "اكستريل", "جuke", "ماكسيما", "مورانو", "باثفايندر", "تيدا", "كيكس", "سينترا"],
            "شيفروليه": ["كابتيفا", "ماليبو", "كروز", "تاهو", "سيلفرادو", "كمارو", "إكوينوكس", "بليزر", "سوبربان", "كورفيت", "اسبارك", "افيو"],
            "هوندا": ["أكورد", "سيفيك", "CR-V", "بايلوت", "اتش آر-في", "سيتي", "جاز", "ريدج لاين", "أوديسي"],
            "ميتسوبيشي": ["لانسر", "باجيرو", "أوتلاندر", "ASX", "مونتيرو", "Eclipse Cross", "Attrage"],
            "بي إم دبليو": ["الفئة 3", "الفئة 5", "الفئة 7", "X3", "X5", "X6", "X7", "الفئة 2", "الفئة 4", "Z4"],
            "فورد": ["موستانج", "إكسبلورر", "إسكيب", "F-150", "رينجر", "إيدج", "اكسبيديشن", "ترانزيت"],
            "ليكزس": ["ES", "LS", "RX", "LX", "NX", "UX", "GX", "IS", "RC", "LC"],
            "جيب": ["رانجلر", "جراند شيروكي", "كومباس", "رينيجيد", "شيروكي", "غلادياتور"],
            "أودي": ["A3", "A4", "A6", "A8", "Q3", "Q5", "Q7", "Q8", "R8", "TT"],
            "فولكس فاجن": ["جولف", "باسات", "بولو", "تيغوان", "طوارق", "جيتا", "أرتيون", "ترانسپورتر"],
            "سوزوكي": ["سويفت", "فيتارا", "إرتيجا", "بالينو", "سياز", "جمني", "كاري"],
            "إيسوزو": ["D-Max", "MU-X", "إفريقيا"],
            "شانجان": ["CS35", "CS55", "CS75", "CS95", "Eado", "Alsvin", "UNI-K", "UNI-T"],
            "جيلي": ["إمجراند", "كول راي", "تاكون", "أزكارا", "مونجارو"],
            "بي واي دي": ["F3", "S6", "تانغ", "سونغ", "يوان", "دولفين", "سيل"],
            "مازدا": ["3", "6", "CX-3", "CX-5", "CX-9", "MX-5", "BT-50"],
            "سوبارو": ["امبريزا", "ليجاسي", "اوت باك", "فورستر", "XV", "WRX", "BRZ"],
            "رينو": ["داستر", "لوجان", "سانديرو", "كابتشر", "كوليوس", "ميجان", "كليو"],
            "بيجو": ["301", "308", "508", "2008", "3008", "5008", "بارتنر", "إكسبرت"],
            "سيتروين": ["C-Elysee", "C4", "C5", "C3", "C4 Cactus", "برلينجو"],
            "هافال": ["H2", "H6", "H9", "Jolion", "Dargo", "H6S"],
            "شيري": ["تيجو 2", "تيجو 3", "تيجو 4", "تيجو 7", "تيجو 8", "أريزو"],
            "MG": ["5", "6", "ZS", "HS", "RX5", "RX8", "GT", "Cyberster"],
            "تانك": ["300", "500"],
            "لافيدا": ["Sedan", "Hatchback"],
            "كريستال": ["Sedan", "SUV"]
        };

        const sudanStates = [
            "الخرطوم", "الجزيرة", "البحر الأحمر", "نهر النيل", "القضارف", 
            "شمال كردفان", "جنوب كردفان", "غرب كردفان", "شمال دارفور", 
            "جنوب دارفور", "غرب دارفور", "شرق دارفور", "وسط دارفور", 
            "سنار", "كسلا", "النيل الأبيض", "النيل الأزرق", "الشمالية"
        ];

        let selectedPayment = null;
        let paymentProofUploaded = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateBrands();
            populateYears();
            populateStates();
            
            // Check login
            const userData = JSON.parse(localStorage.getItem('userData') || '{}');
            if (!userData.isLoggedIn) {
                if (confirm('يجب تسجيل الدخول أولاً لإضافة إعلان. هل تريد الانتقال إلى صفحة تسجيل الدخول؟')) {
                    window.location.href = 'login.html';
                }
            }
        });

        function populateBrands() {
            const select = document.querySelector('select[name="brand"]');
            carBrands.forEach(brand => {
                select.innerHTML += `<option value="${brand}">${brand}</option>`;
            });
        }

        function updateModels() {
            const brand = document.querySelector('select[name="brand"]').value;
            const modelSelect = document.getElementById('modelSelect');
            
            modelSelect.innerHTML = '<option value="">اختر الموديل</option>';
            
            if (brand && carModels[brand]) {
                carModels[brand].forEach(model => {
                    modelSelect.innerHTML += `<option value="${model}">${model}</option>`;
                });
                modelSelect.disabled = false;
            } else {
                modelSelect.disabled = true;
            }
        }

        function populateYears() {
            const select = document.querySelector('select[name="year"]');
            const currentYear = 2026;
            for (let year = currentYear; year >= 1990; year--) {
                select.innerHTML += `<option value="${year}">${year}</option>`;
            }
        }

        function populateStates() {
            const select = document.querySelector('select[name="state"]');
            sudanStates.forEach(state => {
                select.innerHTML += `<option value="${state}">${state}</option>`;
            });
        }

        function goToStep(step) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            
            // Show target step
            document.getElementById('step' + step).classList.add('active');
            
            // Update tabs
            for (let i = 1; i <= 3; i++) {
                const tab = document.getElementById('step' + i + 'Tab');
                if (i === step) {
                    tab.classList.add('border-primary', 'text-primary', 'bg-primary/5');
                    tab.classList.remove('border-transparent', 'text-slate-500');
                } else if (i < step) {
                    tab.classList.add('border-green-500', 'text-green-600');
                    tab.classList.remove('border-primary', 'text-primary', 'bg-primary/5', 'border-transparent', 'text-slate-500');
                    tab.innerHTML = '<span class="material-symbols-outlined align-middle ml-1">check_circle</span> ' + getStepName(i);
                } else {
                    tab.classList.add('border-transparent', 'text-slate-500');
                    tab.classList.remove('border-primary', 'text-primary', 'bg-primary/5', 'border-green-500', 'text-green-600');
                }
            }
        }

        function getStepName(step) {
            const names = ['بيانات السيارة', 'الصور', 'الدفع'];
            return names[step - 1];
        }

        function previewImage(input, previewId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById(previewId);
                    preview.src = e.target.result;
                    preview.classList.remove('hidden');
                    
                    // Hide placeholder for main image
                    if (previewId === 'mainPreview') {
                        document.getElementById('mainPlaceholder').classList.add('hidden');
                    }
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function selectPayment(method) {
            selectedPayment = method;
            
            // Reset all cards
            document.querySelectorAll('.payment-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelectorAll('[id$="Check"] > div').forEach(check => {
                check.classList.add('hidden');
            });
            document.querySelectorAll('[id$="Details"]').forEach(details => {
                details.classList.add('hidden');
            });
            
            // Select current
            document.getElementById(method + 'Card').classList.add('selected');
            document.getElementById(method + 'Check').querySelector('div').classList.remove('hidden');
            document.getElementById(method + 'Details').classList.remove('hidden');
            
            checkSubmitButton();
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('تم نسخ الرقم: ' + text);
            });
        }

        function handleProofUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.querySelector('#proofPreview img');
                    preview.src = e.target.result;
                    document.getElementById('proofPreview').classList.remove('hidden');
                    paymentProofUploaded = true;
                    checkSubmitButton();
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function removeProof() {
            document.getElementById('paymentProof').value = '';
            document.getElementById('proofPreview').classList.add('hidden');
            paymentProofUploaded = false;
            checkSubmitButton();
        }

        function checkSubmitButton() {
            const btn = document.getElementById('submitBtn');
            if (selectedPayment && paymentProofUploaded) {
                btn.disabled = false;
            } else {
                btn.disabled = true;
            }
        }

        function handleSubmit(e) {
            e.preventDefault();
            
            if (!selectedPayment || !paymentProofUploaded) {
                showToast('الرجاء اختيار طريقة الدفع وإرفاق إيصال الدفع');
                return;
            }

            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.innerHTML = '<span class="material-symbols-outlined animate-spin">refresh</span> جاري الإرسال...';

            // Simulate API call
            setTimeout(() => {
                showToast('تم إرسال الإعلان بنجاح! سيتم مراجعته خلال 24 ساعة.');
                setTimeout(() => {
                    window.location.href = 'my-ads.html';
                }, 2000);
            }, 2000);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            toastMessage.textContent = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        }

        if (localStorage.getItem('theme') === 'dark') {
            document.documentElement.classList.add('dark');
        }
    </script>
</body>
</html>